search for function strstr first
ref1:http://www.cplusplus.com/reference/cstring/strstr/
Returns a pointer to the first occurrence of str2 in str1, or a null pointer if str2 is not part of str1.

in order to pass the check the strstr should return null

pay attention to line 18
	if(strstr(argv[1], "token") != NULL){...}
	it is hard coded
so find a way to change the file name
search for 'how to change file name in linux'

'mv token nekot'
however permission denied

let's search for function open, read and write first

open
ref:http://pubs.opengroup.org/onlinepubs/009695399/functions/open.html

	int open(const char *path, int oflag, ... );
	O_RDONLY: Open for reading only.
	Upon successful completion, the function shall open the file and return a non-negative integer representing the lowest numbered unused file descriptor. Otherwise, -1 shall be returned and errno set to indicate the error. No files shall be created or modified if the function returns -1.

	wiki of file descriptor:
	http://en.wikipedia.org/wiki/File_descriptor

	Q:when will the file descriptor return 0, 1 and 2
	A:TO DO

read
ref:http://pubs.opengroup.org/onlinepubs/009695399/functions/read.html

ssize_t read(int fildes, void *buf, size_t nbyte);
	The read() function shall attempt to read nbyte bytes from the file associated with the open file descriptor, fildes, into the buffer pointed to by buf. The behavior of multiple concurrent reads on the same pipe, FIFO, or terminal device is unspecified.

	Upon successful completion, read() [XSI] [Option Start]  and pread() [Option End] shall return a non-negative integer indicating the number of bytes actually read. Otherwise, the functions shall return -1 and set errno to indicate the error.

write

ref: http://pubs.opengroup.org/onlinepubs/009695399/functions/write.html
ssize_t write(int fildes, const void *buf, size_t nbyte);

	The write() function shall attempt to write nbyte bytes from the buffer pointed to by buf to the file associated with the open file descriptor, fildes.

	Upon successful completion, write() [XSI] [Option Start]  and pwrite() [Option End] shall return the number of bytes actually written to the file associated with fildes. This number shall never be greater than nbyte. Otherwise, -1 shall be returned and errno set to indicate the error.


it seems not helpful after reviewing these documents

try to find some info about strstr buffer overflow, however after one hour attempt, just give up

as mentioned at first, the way to bypass is to change the file name without change the content.
so another way is to create a link

'ln /home/flag04/token aaa'
	permission denied

change to /tmp folder
'ln /home/flag04/token aaa'
	invalid cross-device link

use the symbolic link
'ln -s /home/flag04/token aaa'
file aaa is created

then run with aaa again
'/home/flag04/flag04 aaa'
	get a string '06508b5e-8909-4f38-b630-fdb148a848a2'
have no idea about what this is yet




	