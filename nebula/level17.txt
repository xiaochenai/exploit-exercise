Possible vulnerable points:
line 14 //If load function is vulnerable then we can manipulate the user input to exploit

pickle: https://docs.python.org/2/library/pickle.html

pickle.load(file)
Read a string from the open file object file and interpret it as a pickle data stream, reconstructing and returning the original object hierarchy. This is equivalent to Unpickler(file).load().

file must have two methods, a read() method that takes an integer argument, and a readline() method that requires no arguments. Both methods should return a string. Thus file can be a file object opened for reading, a StringIO object, or any other custom object that meets this interface.

This function automatically determines whether the data stream was written in binary mode or not.


ref: https://blog.nelhage.com/2011/03/exploiting-pickle/


To generate the shell code:
ref: https://lincolnloop.com/blog/playing-pickle-security/
ref: http://stackoverflow.com/questions/10282175/attacking-pythons-pickle
ref: https://blog.nelhage.com/2011/03/exploiting-pickle/

python shellcode.py | nc 127.0.0.1 10007

then cat /tmp/level17: 
You have successfully......

TODO: source code, details, refs
ref:https://github.com/1u4nx/Exploit-Exercises-Nebula/blob/master/Level17%E2%80%94%E2%80%94Python%E7%9A%84pickle%E6%A0%BC%E5%BC%8F%E5%8F%AF%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E6%BC%8F%E6%B4%9E.md


1h